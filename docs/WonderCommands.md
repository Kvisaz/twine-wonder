# Команды Wonder

[Пользовательский скрипт](Scripts.md) JS может использовать методы объекта Wonder. Вместо `Wonder` можно использовать сокращенноё `w`.

## Показать текст
Можно показать текст в месте, где скрипт. Удобно для проверки на параметры и условия, для показа особых линков и кусков текста.

Эта команда не работает в стартовом скрипте, работает только в тексте пассажа (страницы)
```
Начало текста
{{
    Wonder.showText('Кастомный текст'); // показать кастомный текст
}}
Продолжение текста

```

## Save/Load

Чтобы включить автосейв, используйте в пользовательском скрипте такие строки:
```javascript
Wonder.saveSlot('saveslot_TEST'); // определяет название слота
Wonder.autoSave();               // включает автосейв при каждом ходе       
Wonder.load();          // загрузить последнее сохранение, если есть
```

Также можно в тексте пассажей использовать вставки скриптов с помощью `{{ вставьте скрипт здесь }}` с командами save и load в таком виде
```js
{{ 
    Wonder.save('save_slot1'); // сохранить в слоте save_slot1
 }} 
```
и
```js
{{ 
    Wonder.load('save_slot1'); // загрузить из слота save_slot1
 }} 
```

При загрзуке игра перейдет на ту страницу (passage), на которой было сделано сохранение.

## СSS
Подключить кастомный css из внешнего URL

`Wonder.styleUrl('mystyle.css');`

## Звуки и музыка

Просто запустить музыку в любой момент

`Wonder.music(url: string, volume = 1)`

Запустить музыку на локации `hashName`

`Wonder.musicFor(hashName: string, url: string, volume = 1`

Выключить музыку 
`Wonder.musicStop();`

По умолчанию музыка зациклена. Чтобы проиграть звуковой эффект без повторения
`Wonder.sound(url, volume);`

## Коллекционки

Можно собирать страницы с определенным тегом (в Twine) в [коллекции](Collectibles.md).

```javascript
Wonder.collect({
    // можно выбирать сразу кучу тегов
    tags: ['gameover'],
    // читабельный заголовок для пользователя
    title: 'Концовки', 
    // добавить в конце любой HTML.
    addAfter: '<div id="restartButton">[[Начать заново|start]]</div>', 
    // показывать автобэк
    hideBack: true,
    // сохранять собранные id в коллекцию
    collection: 'gameovers'
})
```

## PostMessage API

Если игра запускается в iframe, то можно включить связь с родителем, обмен через postMessage.  Event.data в postMessage протоколе должен содержать поля
- name: название сообщения
- data: данные сообщения (необязательно)

Подписка на получение сообщения от родителя.
```
Wonder.parentApi().on('start', (state)=> {
    console.log('state: ', state);
});
```

Сохранить состояние.
```
Wonder.parentApi().send('save', state);
```




